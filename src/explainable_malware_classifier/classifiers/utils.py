import functools
import time

import pandas as pd

from explainable_malware_classifier.settings import DATASETS_DIR_PATH


def comma_tokenizer(text: str) -> list[str]:
    return text.split(",")


def load_dataset(name: str) -> pd.DataFrame:
    dataset_path = DATASETS_DIR_PATH / name
    if not dataset_path.exists():
        raise FileNotFoundError(
            f"Dataset '{name}' not found in the datasets directory '{DATASETS_DIR_PATH}'."
        )
    return pd.read_csv(dataset_path)


def timer(func):
    """Print the runtime of the decorated function"""

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        start_time = time.perf_counter()
        value = func(*args, **kwargs)
        end_time = time.perf_counter()
        run_time = end_time - start_time
        print(f"Finished {func.__qualname__}() in {run_time:.2f} secs")
        return value

    return wrapper
